# Redis

## 练习题

1. 解答题

（1）什么是NoSQL？

NoSQL表示“not only sql”，泛指一切非关系型数据库，例如KV存储、文档型和图数据库等等。

（2）redis的应用场景？

redis是一种KV存储的数据库。应用场景：缓存、分布式锁、消息队列、搜索引擎、排行榜、点赞/关注和共同好友等等。

（3）redis的几种数据类型描述？

* string：字符串，属于最基本数据 类型
* hash：散列表类型，可以当字典用
* list：列表类型，可以当做队列或者堆栈使用
* set：集合类型，元素不可重复，可做并交差集合运算
* sorted set：有序集合，每个元素带一个分数，按分数排序

（4）redis的几种持久化机制，各自的优缺点？

redis持久化分为三种：RDB、AOF和混合模式。RDB模式是对redis内存数据整个做一个快照，相当于是内存数据在那一瞬间的镜像，然后该镜像被写入磁盘文件中间，后缀名为.rdb。Redis在持久化期间不能对客户端停止响应，因此它会开辟一个新的子进程来执行持久化操作，这利用了Linux的Copy-on-Write（COW）技术，子进程看到的是它创建的一瞬间的内存，主进程新的写请求会复制一份内存数据页，故持久化和处理客户端请求互不影响。它的优点是体积小，redis重新启动时加载速度快；缺点是在做持久化时如果宕机了丢失的数据较多。

而采用AOF模式的话，redis会将每次写操作写入AOF文件中，形成一个操作日志。一旦发生宕机，redis重启的时候就会从AOF文件中读取所有操作，然后按先后顺序执行，还原redis内存中的数据。每发生一次写操作，redis就会往AOF文件中写一条记录，数据会缓存到AOF文件描述符所对应的内核空间中的缓冲区中，然后再由内核异步写入磁盘。AOF文件会越写越大，因此一段时间后会对AOF文件进行瘦身，即redis会重新启动一个子进程将内存中的数据转换成AOF操作并写入AOF文件，然后再将写入期间产生的写操作追加到后面，并替换原有的AOF文件。它的优点是发生宕机时丢失的数据少（最多丢失内核缓冲区中还没来得及写入磁盘的数据），缺点是redis重启后重放AOF文件中的日志所花费的时间比RDB更长。

混合模式结合了RDB和AOF各自的优点，试图弥补各自的不足。混合模式下redis会先将内存快照写入文件，然后再将持久化期间产生的写操作以AOF格式附加到后面。这样一旦服务器宕机，redis重启时会先用RDB部分快速恢复内存数据，然后再重放少量的AOF操作即可。