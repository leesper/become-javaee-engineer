# Spring框架

## 练习题

1. Spring是什么，谈谈你的理解?

Spring是一套开源的Java框架，提供被称为“控制反转”和AOP的两大核心功能。开发人员在做开发的时候不可避免地要处理两种情况，一个是对象的创建，另一个是对象的依赖。当项目复杂到一定程度，或者按照分层架构设计时，就会产生复杂的对象依赖关系。Controller对象依赖Service对象，Service对象依赖Dao对象。开发人员如果自己组装，会非常复杂且容易出错。Spring框架通过控制反转，通过工厂设计模式替开发人员处理了对象的创建，并通过Spring容器管理；又通过依赖注入帮助开发人员建立对象之间复杂的依赖关系。而AOP则以一种非侵入的方式增强了对象的功能，其思想和装饰者模式相似。

2. Spring 的优点？

Spring框架最大的优点就是能与Java世界大量的第三方框架和类库进行整合，并且自身也基于Spring框架提供了大量的企业级框架，逐渐形成了Spring全家桶，一站式搞定所有开发任务，包括微服务。

3. Spring的IoC理解？

IoC是控制反转的意思。所谓控制反转，是指本来需要开发人员处理的对象创建和对象依赖关系组装的任务，现在由框架来负责。框架通过工厂模式管理对象创建，通过依赖注入为bean对象的属性注入值。

4. 什么是依赖注入？

依赖注入就是通过XML或者注解，为Spring容器管理的bean对象注入属性值，通过构造函数或者setter方法的方式。

5. Spring中的的注解有哪些，并描述其作用？

* @Component：bean标签对应注解，衍生@Repository、@Controller和@Service
* @Scope：对应bean标签scope属性
* @PostConstruct：对应bean标签init-method属性
* @PreDestroy：对应bean标签destroy-method属性
* @Autowired：用于进行对象的依赖注入
* @Qualifier：通过ID进行注解，常用于一个接口多个实现类的情况
* @Configuration：标识配置类
* @ComponentScan：对应XML配置文件中的context:component-scan，用来扫描Bean类型
* @Import引入其他的配置类，这些配置类不能用@Configuration修饰否则容易出错
* @PropertySource：指定要读取的properties文件
* @Value：对成员变量赋初始值
* @Bean：标记一个方法的返回值为bean对象，放到Spring容器中维护

6. AOP概述

AOP全称是“面向切面编程”。我的理解，OOP是从纵向，即类的继承关系来组织代码，而AOP则是横向切开代码逻辑，将其分为不同部分，然后在不修改原代码的前提下通过代理技术对代码进行增强，这样就可以把一些琐碎的通用功能抽象出来，便于维护。比如记录日志，提交事务等这种“事务性代码”就可以从业务逻辑中抽离出来。

7. 什么是代理模式？描述静态代理和动态代理。

代理模式是设计模式的一种。静态代理通常说来是将“真实对象”替换成代理对象，通过对代理对象进行调用来间接调用被代理的真实对象，因此代理对象扮演的是一个中间人的角色。代理对象在调用真实对象时可以增加自己的代码逻辑。而动态代理则更进一步，通过编写类实现InvocationHander接口，就可以通过invoke方法将对代理对象的调用分发到被代理对象的方法上。动态代理能够依靠反射动态地生成代理对象并动态地执行代理方法调用。

8. SpringAOP五种通知类型描述

* before：在切点（被增强的业务方法）执行前执行
* after-returning：在切点正常执行之后执行，可以对返回值进行增强，如果抛异常则不执行
* after：在切点执行完毕之后，返回之前执行，无论是否抛异常都会执行，适合用来进行清理
* after-throwing：在抛出异常后执行
* around：可以自定义控制通知方法在上述4种位置执行

9. 解答题：基于注解的AOP配置完成入门案例（需提交代码）

参考代码springaopannotation

10. 解答题

（1）什么是事务？有什么用？

事务是将一组操作捆绑在一起进行“原子化”的操作，这组操作要么都成功，要么都失败，避免多组操作不同步导致的一致性问题。比如银行转账操作就需要事务，两方账户资金的变化要对应的起来。

（2）事务的并发会产生的问题有哪些？

* 脏读（空高兴）：操作数据库给员工A的工资加了1万块钱，还没提交事务，A查询工资表发现自己多了一万，这种读到还没提交的事务的情况叫脏读
* 幻读（见鬼了）：A查询数据库发现工资1万以上的员工有10个，此时事务未结束；新入职2个工资1万以上的员工，A事务再查询的时候发现变成了12个
* 不可重复读（找不到）：A发起事务查询自己工资为1万块，此时事务未结束；B操作数据库表给A涨到了1.2万块；A事务再次查询发现自己工资变成1.2万块，以前的1万块读不到了

（3）不可重复读和幻读的区别？

不可重复读是指数据前后读到的值不一致，前一个值再也读不到了；幻读是指记录数发生变化。

（4）spring 事务隔离级别？

* read uncommitted：读未提交，“空高兴”、“见鬼了”和“找不到”都有可能出现
* read committed：读已提交，能解决“空高兴”，但有可能“见鬼了”和“找不到”
* repeatable read：可重复读，能解决“空高兴”和“找不到”，但还是可能“见鬼了”
* serializable：完全串行化，上述情况都不可能出现

隔离级别越高，效率越低，但越安全。

11. 编程题：完成Spring基于注解的事务配置案例（需提交代码）

参考代码springtransactionannotation。